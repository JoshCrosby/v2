function wd3MapChart(t,e){if(void 0==d3)return alert("d3 library is not loaded"),!1;void 0==t&&(t="body");var a=document.querySelector(t);if(void 0==a)return void console.log("wd3BarChart Error: undefined parent");void 0==e&&(e={}),void 0==e.width&&(e.width=getWidth(a)),void 0==e.height&&(e.height=getHeight(a)),void 0!=e.debug&&console.log(e),e.height<20&&(e.height=250),e.width<20&&(e.width=350);var i={"1st":"#3399ff","2nd":"#805393","3rd":"#9c71ae","4th":"#ae8cbd","5th":"#c8afd2","6th":"#d9c8e0",defaultFill:"#e5e5e5"};if(void 0==document.querySelector(t+" .datamap")){var r={width:e.width,height:e.height,scope:"usa","class":"haha",fills:i,element:document.querySelector(t),data:{},legend:!1,labels:!0,id:"map",geographyConfig:{popupTemplate:function(t,e){return"<div class=hoverinfo><strong>"+t.properties.name+": "+wd3NumberWithCommas(e.value)+"</strong></div>"}}};wd3MapChartMaps[t]=new Datamap(r),r.legend&&wd3MapChartMaps[t].legend(),r.labels&&wd3MapChartMaps[t].labels(),void 0!=e.onclick&&d3.selectAll(t+" .datamaps-subunit").on("click",function(t){var a=new Array;a.push(d3.select(this).attr("data-label")),a.push(d3.select(this).attr("data-value")),window[e.onclick].apply(this,a)}),d3.select(t).append("div").attr("class","legend").text(""),d3.select(t+" .legend").append("span").text("Most");for(var n in i)d3.select(t+" .legend").append("span").attr("class","icon-blank").attr("style","color:"+i[n]);d3.select(t+" .legend").append("span").text("Least")}return void 0!=e.csv?(void 0!=e.debug&&console.log("loading csv"),d3.csv(e.csv,function(a,i){for(var r=i,n=0;n<i.length;n++)r[r[n].id]=r[n],delete r[n].id,delete r[n];if(wd3MapChartMaps[t].updateChoropleth(r),void 0!=e.onclick)for(var d in r)d3.select(t+" .datamaps-subunit."+d).attr("data-value",+r[d].value).attr("data-label",+d)})):void 0!=e.tsv?(void 0!=e.debug&&console.log("loading tsv"),d3.tsv(e.tsv,function(a,i){for(var r=i,n=0;n<i.length;n++)r[r[n].id]=r[n],delete r[n].id,delete r[n];if(wd3MapChartMaps[t].updateChoropleth(r),void 0!=e.onclick)for(var d in r)d3.select(t+" .datamaps-subunit."+d).attr("data-value",+r[d].value).attr("data-label",+d)})):void 0!=e.json?(void 0!=e.debug&&console.log("loading json"),d3.json(e.json,function(a,i){for(var r=i,n=0;n<i.length;n++)r[r[n].id]=r[n],delete r[n].id,delete r[n];if(wd3MapChartMaps[t].updateChoropleth(r),void 0!=e.onclick)for(var d in r)d3.select(t+" .datamaps-subunit."+d).attr("data-value",+r[d].value).attr("data-label",+d)})):void 0!=e.data&&(void 0!=e.debug&&console.log("loading data"),wd3MapChartMaps[t].updateChoropleth(e.data)),!1}function wd3NumberWithCommas(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function wd3BarChart(t,e){function a(t){t.forEach(function(t){t.value=+t.value,void 0!=e.rightvalue&&(t.linevalue=+t[e.rightvalue])}),n.domain(t.map(function(t){return t.label})),d.domain([0,d3.max(t,function(t){return t.value})]),void 0!=e.rightvalue&&u.domain([0,d3.max(t,function(t){return t.linevalue})]),h.select(".x.axis").transition().duration(300).call(o).selectAll("text").attr("y",0).attr("x",9).attr("dy",".35em").attr("transform","rotate(90)").style("text-anchor","start"),h.select(".y.axis").transition().duration(300).call(l),void 0!=e.rightvalue&&h.select(".y.axisline").transition().duration(300).call(v);var a=h.selectAll("rect").data(t,function(t){return t.label});if(a.exit().transition().duration(300).attr("y",d(0)).attr("height",e.height-d(0)).style("fill-opacity",1e-6).remove(),a.enter().append("rect").attr("fill",r.range()[0]).attr("y",d(0)).attr("height",e.height-d(0)).attr("data-value",function(t){return t.value}).attr("data-label",function(t){return t.label}).on("mouseover",function(){var t=d3.select(this).style("fill");d3.select(this).attr("fill_ori",t),d3.select(this).style("fill",d3.rgb(t).darker(.3))}).on("mouseout",function(){var t=d3.select(this).attr("fill_ori");d3.select(this).style("fill",t)}).on("click",function(){if(void 0!=e.onclick){var t=new Array;t.push(d3.select(this).attr("data-label")),t.push(d3.select(this).attr("data-value")),window[e.onclick].apply(this,t)}}),a.transition().duration(300).attr("x",function(t){return n(t.label)}).attr("width",n.rangeBand()).attr("y",function(t){return d(t.value)}).attr("height",function(t){return e.height-d(t.value)}),void 0!=e.rightvalue){var i=h.selectAll("path.line").data(t,function(t){return t.label});i.exit().transition().duration(300).remove(),i.enter().append("path").attr("class","line").attr("style","fill:none;stroke:"+s+";stroke-width:3;z-index:999;").attr("d",c(t)),i.transition().duration(300).attr("d",c(t))}}if(void 0==d3)return alert("d3 library is not loaded"),!1;void 0==t&&(t="body");var i=document.querySelector(t);if(void 0==i)return void console.log("wd3BarChart Error: undefined parent");void 0==e&&(e={}),void 0==e.width&&(e.width=getWidth(i)),void 0==e.height&&(e.height=getHeight(i)),void 0==e.top&&(e.top=30),void 0==e.right&&(e.right=55),void 0==e.bottom&&(e.bottom=50),void 0==e.left&&(e.left=80),void 0==e.padding&&(e.padding=1),void 0==e.yticks&&(e.yticks=10),void 0==e.label&&(e.label="label"),void 0==e.duration&&(e.duration=300),void 0!=e.debug&&console.log(e),e.height<20&&(e.height=300),e.width<20&&(e.width=300),e.width=e.width-e.left-e.right,e.height=e.height-e.top-e.bottom;var r=d3.scale.category20(),n=d3.scale.ordinal().rangeRoundBands([0,e.width],.1),d=d3.scale.linear().range([e.height,0]),o=d3.svg.axis().scale(n).orient("bottom").ticks(e.xticks);void 0!=e.xformat&&o.tickFormat(d3.format(e.xformat));var l=d3.svg.axis().scale(d).orient("left").ticks(e.yticks);if(void 0!=e.yformat&&l.tickFormat(d3.format(e.yformat)),void 0!=e.rightvalue){var s=r.range()[2],c=d3.svg.line().x(function(t){return n(t.label)+10}).y(function(t){return u(t.linevalue)}),u=d3.scale.linear().range([e.height,0]);void 0==e.rightticks&&(e.rightticks=10);var v=d3.svg.axis().scale(u).orient("right").ticks(e.rightticks);void 0!=e.rightformat&&v.tickFormat(d3.format(e.rightformat))}if(void 0==document.querySelector(t+" svg")){void 0!=e.debug&&console.log("new bar chart - adding svg"),d3.select(t).append("div").attr("class","title text-center").text("");var h=d3.select(t).append("svg").attr("width",e.width+e.left+e.right).attr("height",e.height+e.top+e.bottom).append("g").attr("transform","translate("+e.left+","+e.top+")");h.append("g").attr("class","x axis").attr("transform","translate(0,"+e.height+")"),h.append("g").attr("class","y axis").append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end"),void 0!=e.rightvalue&&h.append("g").attr("class","y axisline").attr("transform","translate("+e.width+" ,0)").append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","start")}else{void 0!=e.debug&&console.log("existing chart - updating");var h=d3.select(t+" svg")}return void 0!=e.csv?(void 0!=e.debug&&console.log("loading csv"),d3.csv(e.csv,a)):void 0!=e.tsv?(void 0!=e.debug&&console.log("loading tsv"),d3.tsv(e.tsv,a)):void 0!=e.json?(void 0!=e.debug&&console.log("loading json"),d3.json(e.json,a)):void 0!=e.data&&(void 0!=e.debug&&console.log("loading data"),a(e.data)),!1}function wd3LineChart(t,e){function a(t){var a=Object.keys(t[0]);for(ykeys=new Array,i=0;i<a.length;i++){var r=a[i];r!=e.label&&ykeys.push(r)}for(t.forEach(function(t){for(t.xval=+t[e.label],i=0;i<ykeys.length;i++){var a=ykeys[i];t[a]=+t[a]}}),o.domain(d3.extent(t,function(t){return t.xval})),l.domain([d3.min(t,function(t){var e=new Array;for(i=0;i<ykeys.length;i++){var a=ykeys[i];e.push(+t[a])}return Math.min.apply(null,e)})+-1,d3.max(t,function(t){var e=new Array;for(i=0;i<ykeys.length;i++){var a=ykeys[i];e.push(+t[a])}return Math.max.apply(null,e)})+1]),v=0;v<ykeys.length;v++)d.append("path").attr("class","line").style("stroke",n.range()[v]).attr("d",u[v](t));for(d.append("g").attr("class","x-axis kpi").attr("transform","translate(0,"+e.height+")").call(s),d.append("g").attr("class","y-axis kpi").call(c),v=0;v<ykeys.length;v++)d.append("text").attr("x",50*v).attr("y",e.height+e.top+5).attr("class","legend").style("fill",n.range()[v]).text(ykeys[v])}if(void 0==d3)return alert("d3 library is not loaded"),!1;void 0==t&&(t="body");var r=document.querySelector(t);if(void 0==r)return void console.log("wd3PieChart Error: undefined parent");void 0==e&&(e={}),void 0==e.width&&(e.width=getWidth(r)),void 0==e.height&&(e.height=getHeight(r)),void 0==e.padding&&(e.padding=1),void 0==e.yticks&&(e.yticks=10),void 0==e.label&&(e.label="label"),void 0==e.duration&&(e.padding=1e3),void 0!=e.debug&&console.log(e),e.height<20&&(e.height=300),e.width<20&&(e.width=300);var n=d3.scale.category20();if(void 0==document.querySelector(t+" svg")){void 0!=e.debug&&console.log("new chart - adding svg"),d3.select(t).append("div").attr("class","title text-center").text("");var d=d3.select(t).append("svg").attr("width",e.width).attr("height",e.height).append("g");d.append("g").attr("class","slices"),d.append("g").attr("class","labels"),d.append("g").attr("class","lines"),d.attr("transform","translate("+e.width/2+","+e.height/2+")")}else{void 0!=e.debug&&console.log("existing chart - updating");var d=d3.select(t+" svg")}var o=d3.scale.linear().range([0,e.width]),l=d3.scale.linear().range([e.height,0]),s=d3.svg.axis().scale(o).orient("bottom").ticks(e.xticks);void 0!=e.xformat&&s.tickFormat(d3.format(e.xformat));var c=d3.svg.axis().scale(l).orient("left").ticks(e.yticks);void 0!=e.yformat&&c.tickFormat(d3.format(e.yformat));for(var u=new Array,v=0;10>v;v++)u[v]=d3.svg.line().interpolate("basis").x(function(t){return o(t.xval)}).y(function(t,e){var a=ykeys[e];return l(t[a])});return void 0!=e.csv?(void 0!=e.debug&&console.log("loading csv"),d3.csv(e.csv,a)):void 0!=e.tsv?(void 0!=e.debug&&console.log("loading tsv"),d3.tsv(e.tsv,a)):void 0!=e.json?(void 0!=e.debug&&console.log("loading json"),d3.json(e.json,a)):void 0!=e.data?(void 0!=e.debug&&console.log("loading data"),a(e.data)):(void 0!=e.debug&&console.log("loading random data"),a(wd3RandomLineData())),!1}function wd3PieChart(t,e){function a(a){function i(t){return t.startAngle+(t.endAngle-t.startAngle)/2}a.forEach(function(t){t.value=+t.value});var u=d3.sum(a,function(t){return t.value});a.forEach(function(t){t.percent=Math.round(t.value/u*100,1)});var v=n.select(".slices").selectAll("path.slice").data(c(a),s);v.enter().insert("path").style("fill",function(t,a){return void 0!=e.debug&&console.log("new slice:i="+a+",color="+r.range()[a]+", label="+t.data.label),r.range()[a]}).attr("class","slice"),v.attr("data-percent",function(t){return t.data.percent}),v.attr("data-value",function(t){return t.data.value}),v.attr("data-label",function(t){return t.data.label}),v.on("mouseover",function(){var e=d3.select(this).style("fill");d3.select(this).attr("fill_ori",e),d3.select(this).style("fill",d3.rgb(e).darker(.3)),d3.select(t+" .title").text(d3.select(this).attr("data-percent")+"%")}),v.on("mouseout",function(){var e=d3.select(this).attr("fill_ori");d3.select(this).style("fill",e),d3.select(t+" .title").text("")}),void 0!=e.onclick&&v.on("click",function(){var t=new Array;t.push(d3.select(this).attr("data-label")),t.push(d3.select(this).attr("data-value")),t.push(d3.select(this).attr("data-percent")),window[e.onclick].apply(this,t)}),v.transition().duration(1e3).attrTween("d",function(t){this._current=this._current||t;var e=d3.interpolate(this._current,t);return this._current=e(0),function(t){return o(e(t))}}),v.exit().remove();var h=n.select(".labels").selectAll("text").data(c(a),s);h.enter().append("text").attr("dy",".35em").text(function(t){return t.data.label}),h.transition().duration(1e3).attrTween("transform",function(t){this._current=this._current||t;var e=d3.interpolate(this._current,t);return this._current=e(0),function(t){var a=e(t),r=l.centroid(a);return i(a)<Math.PI?r[0]=d-12:r[0]=-1*d+12,"translate("+r+")"}}).styleTween("text-anchor",function(t){this._current=this._current||t;var e=d3.interpolate(this._current,t);return this._current=e(0),function(t){var a=e(t);return i(a)<Math.PI?"start":"end"}}),h.exit().remove();var g=n.select(".lines").selectAll("polyline").data(c(a),s);g.enter().append("polyline"),g.transition().duration(1e3).attrTween("points",function(t){this._current=this._current||t;var e=d3.interpolate(this._current,t);return this._current=e(0),function(t){var a=e(t),r=l.centroid(a);return r[0]=.91*d*(i(a)<Math.PI?1:-1),[o.centroid(a),l.centroid(a),r]}}),g.exit().remove()}if(void 0==d3)return alert("d3 library is not loaded"),!1;void 0==t&&(t="body");var i=document.querySelector(t);if(void 0==i)return void console.log("wd3PieChart Error: undefined parent");void 0==e&&(e={}),void 0==e.width&&(e.width=getWidth(i)),void 0==e.height&&(e.height=getHeight(i)),void 0==e.padding&&(e.padding=60),void 0!=e.debug&&console.log(e),e.height<20&&(e.height=300),e.width<20&&(e.width=300);var r=d3.scale.category20();if(void 0==document.querySelector(t+" svg")){void 0!=e.debug&&console.log("new chart - adding svg");var n=d3.select(t).append("svg").attr("width",e.width).attr("height",e.height).append("g");void 0!=e.type&&"donut"==e.type?n.append("text").attr("class","title").attr("text-anchor","middle").attr("transform","translate(0,4)").text(""):d3.select(t).append("div").attr("class","title text-center").text(""),n.append("g").attr("class","slices"),n.append("g").attr("class","labels"),n.append("g").attr("class","lines"),n.attr("transform","translate("+e.width/2+","+e.height/2+")")}else{void 0!=e.debug&&console.log("existing chart - updating");var n=d3.select(t+" svg")}var d=Math.round(Math.min(e.width,e.height)/2)-e.padding;if(void 0!=e.type&&"donut"==e.type){void 0==e.donut&&(e.donut=.4);var o=d3.svg.arc().outerRadius(.8*d).innerRadius(d*e.donut)}else var o=d3.svg.arc().outerRadius(.85*d).innerRadius(0);var l=d3.svg.arc().innerRadius(.9*d).outerRadius(.9*d),s=function(t){return t.data.label},c=d3.layout.pie().value(function(t){return t.value}).sort(null);return void 0!=e.csv?(void 0!=e.debug&&console.log("loading csv"),d3.csv(e.csv,a)):void 0!=e.tsv?(void 0!=e.debug&&console.log("loading tsv"),d3.tsv(e.tsv,a)):void 0!=e.json?(void 0!=e.debug&&console.log("loading json"),d3.json(e.json,a)):void 0!=e.data?(void 0!=e.debug&&console.log("loading data"),a(e.data)):(void 0!=e.debug&&console.log("loading random data"),a(wd3RandomPieData())),!1}function wd3RandomPieData(){var t=d3.scale.ordinal().domain(["Lorem ipsum","dolor sit","amet","consectetur","adipisicing","eiusmod","tempor","incididunt"]),e=t.domain();return e.map(function(t){return{label:t,value:Math.random()}})}var wd3MapChartMaps=new Array;