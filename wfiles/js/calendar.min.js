function Calendar(t,e,i){if(void 0==t)return alert("No Calendar target ID:"+t),!1;var a=getObject(t);if(void 0==a)return alert("No Calendar target named"+t+" found"),!1;this.current_date=new Date,this.current_dateYear=this.current_date.getFullYear(),this.current_dateMonth=this.current_date.getMonth(),this.current_dateDate=this.current_date.getDate(),this.target_id=t,this.id=this.target_id+"_cal",this.dateid=this.id+"_date",this.timeid=this.id+"_time";var s=getObject(this.id);void 0==s&&(void 0==a.style.position,s=document.createElement("div"),s.id=this.id,s.className="w_calendar_div",a.insertAdjacentElement("afterEnd",s));var h=a.getAttribute("data-format");if(void 0!=h)switch(h.toLowerCase()){case"datetime":this.showtime=!0,this.showdate=!0,s.style.width="247px";break;case"time":this.showtime=!0,this.showdate=!1,s.style.width="115px";break;default:this.showdate=!0,this.showtime=!1,s.style.width="200px"}else this.showdate=!0,this.showtime=!1,s.style.width="200px";this.hasvalue=!1;var r=getText(a);if(r.length){this.hasvalue=!0;var n=r.split(/[- :]/);this.showdate&&this.showtime?this.cval=new Date(parseInt(n[0]),parseInt(n[1])-1,parseInt(n[2]),parseInt(n[3]),parseInt(n[4]),parseInt(n[5]),0):this.showdate?this.cval=new Date(parseInt(n[0]),parseInt(n[1])-1,parseInt(n[2]),0,0,0,0):this.showtime&&(this.cval=new Date(this.current_dateYear,this.current_dateMonth,this.current_dateDate,parseInt(n[0]),parseInt(n[1]),parseInt(n[2]),0)),this.cvalYear=this.cval.getFullYear(),this.cvalMonth=this.cval.getMonth(),this.cvalDate=this.cval.getDate(),this.cvalHr=this.cval.getHours(),this.cvalMin=this.cval.getMinutes()}var d="";if(this.showdate){void 0==e&&void 0==i&&r.length&&(e=this.cval.getMonth(),i=this.cval.getFullYear(),this.current_day=this.cval.getDay()),this.month=isNaN(e)||null==e?this.current_date.getMonth():e,this.year=isNaN(i)||null==i?this.current_date.getFullYear():i,this.days_labels=["Su","Mo","Tu","We","Th","Fr","Sa"],this.months_labels=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],this.days_in_month=[31,28,31,30,31,30,31,31,30,31,30,31];var l=new Date(this.year,this.month,1),o=l.getDay();switch(this.month=l.getMonth(),this.year=l.getFullYear(),this.nextyear=parseInt(this.year)+1,this.prevyear=parseInt(this.year)-1,parseInt(this.month)){case 0:this.prevmonth=11,this.nextmonth=this.month+1,this.prevmonthyear=parseInt(this.year)-1,this.nextmonthyear=this.year;break;case 11:this.prevmonth=this.month-1,this.nextmonth=0,this.prevmonthyear=this.year,this.nextmonthyear=parseInt(this.year)+1;break;default:this.prevmonth=this.month-1,this.nextmonth=this.month+1,this.prevmonthyear=this.year,this.nextmonthyear=this.year}var c=this.days_in_month[this.month];1==this.month&&(this.year%4==0&&this.year%100!=0||this.year%400==0)&&(c=29);var v=this.months_labels[this.month];this.showtime&&(d+='<table width="100%"><tr valign="top"><td width="100%" style="padding:0px !important;">'),d+='<table class="w_calendar_table">',d+='	<tr class="w_calendar_month">\n',d+='		<th title="Prev Year" class="w_pointer" onclick="Calendar(\''+this.target_id+"','"+this.month+"','"+this.prevyear+'\');"><span class="icon-dir-left"></span></th>\n',d+='		<th title="Prev Month" class="w_pointer" onclick="Calendar(\''+this.target_id+"','"+this.prevmonth+"','"+this.prevmonthyear+'\');"><span class="icon-arrow-left"></span></th>\n',d+='		<th colspan="3" class="w_calendar_title"><span class="icon-calendar"></span> '+v+"&nbsp;"+this.year+"</th>\n",d+='		<th title="Next Month" class="w_pointer" onclick="Calendar(\''+this.target_id+"','"+this.nextmonth+"','"+this.nextmonthyear+'\');"><span class="icon-arrow-right"></span></th>\n',d+='		<th title="Next Year" class="w_pointer" onclick="Calendar(\''+this.target_id+"','"+this.month+"','"+this.nextyear+'\');"><span class="icon-dir-right"></span></th>\n',d+="	</tr>\n",d+='	<tr class="w_calendar_head">\n';for(var m=0;6>=m;m++)d+="		<th>"+this.days_labels[m]+"</th>\n";d+="	</tr>\n",d+='	<tr class="w_calendar_body">\n';for(var w=1,g=1,m=0;9>m;m++){for(var p=0;6>=p;p++){var _=!1,u=new Date(this.year,this.month,w,0,0,0,0);this.current_dateYear==u.getFullYear()&&this.current_dateMonth==u.getMonth()&&this.current_dateDate==u.getDate()&&(_=!0);var y=!1;if(this.hasvalue&&this.cvalYear==u.getFullYear()&&this.cvalMonth==u.getMonth()&&this.cvalDate==u.getDate()&&(y=!0),d+=0==p||6==p?"		<th":"		<td",y?d+=' class="active"':_&&(d+=' class="today"'),d+=">",c>=w&&(m>0||p>=o)){var f=10>w?"0"+w:w,x=CalendarTwoDigits(this.month+1),D=this.year+"-"+x+"-"+f;d+="<div onclick=\"CalendarSetDate('"+this.target_id+"','"+D+"');\">"+w+"</div>",w++}d+=0==p||6==p?"</th>\n":"</td>\n"}if(w>c)break;d+="	</tr>\n",d+='	<tr class="w_calendar_body">\n',g++}if(d+="</tr>\n",d+="</table>\n",this.showtime){this.timesheight=parseInt(21*g)+15,console.log("rows:"+g),d+='</td><td style="padding:0px !important;" nowrap>\n',d+='<div class="w_bold w_smaller" align="center"><span class="icon-clock"></span>Time</div>\n',this.showtimes=this.id+"_showtimes",d+='<div class="w_calendar_times" id="'+this.showtimes+'" style="height:'+this.timesheight+'px !important;">\n';for(var b=new Array(24,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23),C=new Array("00","30"),I=0;I<b.length;I++){var T,M="am";b[I]>12?(0!=I&&(M="pm"),T=b[I]-12):T=b[I];for(var k=CalendarTwoDigits(b[I]),x=0;x<C.length;x++){var Y=T+":"+C[x]+" "+M,D=k+":"+C[x]+":00",u=new Date(this.current_dateYear,this.current_dateMonth,this.current_dateDate,parseInt(b[I]),parseInt(C[x]),0,0),y=!1;this.hasvalue&&this.cvalHr==u.getHours()&&this.cvalMin==u.getMinutes()&&(y=!0),d+="<div onclick=\"CalendarSetTime('"+this.target_id+"','"+D+'\');" class="w_calendar_time',y&&(d+=" active"),d+='">'+Y+"</div>\n"}}d+="</div>\n",d+="</td></tr><table>\n"}d+='<table class="w_calendar_table">\n',d+="	<tr>\n",this.showtime?(d+='		<td style="width:50%;"><div id="'+this.dateid+'" style="height:15px;text-align:right;padding-right:4px;">',this.hasvalue&&(d+=this.cvalYear+"-"+CalendarTwoDigits(this.cvalMonth+1)+"-"+CalendarTwoDigits(this.cvalDate)),d+="</div></td>\n",d+='		<td style="width:50%"><div id="'+this.timeid+'" style="height:15px;text-align:left;padding-left:4px;">',this.hasvalue&&(d+=CalendarTwoDigits(this.cvalHr)+":"+CalendarTwoDigits(this.cvalMin)+":00"),d+="</div></td>\n"):(d+='		<td><div id="'+this.dateid+'" style="height:15px;text-align:center;">',this.hasvalue&&(d+=this.cvalYear+"-"+CalendarTwoDigits(this.cvalMonth+1)+"-"+CalendarTwoDigits(this.cvalDate)),d+="</div></td>\n"),d+="	</tr>\n",d+="</table>\n"}else if(this.showtime){this.timesheight=200,d+='<div style="width:100px;">\n',d+='<div class="w_bold w_small" align="center"><span class="icon-clock"></span> Time</div>\n',this.showtimes=this.id+"_showtimes",d+='<div class="w_calendar_times" id="'+this.showtimes+'" style="height:'+this.timesheight+'px;">\n';for(var b=new Array(24,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23),C=new Array("00","30"),I=0;I<b.length;I++){var T,M="am";b[I]>12?(0!=I&&(M="pm"),T=b[I]-12):T=b[I];for(var k=CalendarTwoDigits(b[I]),x=0;x<C.length;x++){var Y=T+":"+C[x]+" "+M,D=k+":"+C[x]+":00",u=new Date(this.current_dateYear,this.current_dateMonth,this.current_dateDate,parseInt(b[I]),parseInt(C[x]),0,0),y=!1;this.hasvalue&&this.cvalHr==u.getHours()&&this.cvalMin==u.getMinutes()&&(y=!0),d+="<div onclick=\"CalendarSetTime('"+this.target_id+"','"+D+'\');" class="w_calendar_time',y&&(d+=" active"),d+='">'+Y+"</div>\n"}}d+="</div>\n",d+='<div id="'+this.timeid+'" style="height:15px;text-align:center;">',this.hasvalue&&(d+=CalendarTwoDigits(this.cvalHr)+":"+CalendarTwoDigits(this.cvalMin)+":00"),d+="</div>\n",d+="</div>\n"}d+='	<div class="w_calendar_close" title="Click to close" onclick="hideId(\''+this.id+'\');"><span class="icon-cancel-circled"></span></div>\n',s.innerHTML=d,s.style.display="block";var I=getHeight(s);if(I=parseInt(I)+3,150>I&&(I=150),s.style.bottom="-"+I+"px",s.style.left="0px",s.style.zIndex=this.current_date.getTime(),this.showtime){var N=getObject(this.showtimes);N.scrollTop=320}return!1}function CalendarSetDate(t,e){if(void 0==t)return alert("No Calendar target ID:"+t),!1;var i=getObject(t);if(void 0==i)return alert("No Calendar target named"+t+" found"),!1;var a=i.getAttribute("data-format");if(void 0!=a)switch(a.toLowerCase()){case"datetime":this.showtime=!0,this.showdate=!0;break;case"time":this.showtime=!0,this.showdate=!1;break;default:this.showdate=!0,this.showtime=!1}else this.showdate=!0,this.showtime=!1;if(this.id=t+"_cal",this.dateid=this.id+"_date",this.timeid=this.id+"_time",setText(this.dateid,e),!this.showtime)return setText(t,e),hideId(this.id),!1;var s=getText(this.timeid);return s.length&&(setText(t,e+" "+s),hideId(this.id)),!1}function CalendarSetTime(t,e){if(void 0==t)return alert("No Calendar target ID:"+t),!1;var i=getObject(t);if(void 0==i)return alert("No Calendar target named"+t+" found"),!1;var a=i.getAttribute("data-format");if(void 0!=a)switch(a.toLowerCase()){case"datetime":this.showtime=!0,this.showdate=!0;break;case"time":this.showtime=!0,this.showdate=!1;break;default:this.showdate=!0,this.showtime=!1}else this.showdate=!0,this.showtime=!1;if(this.id=t+"_cal",this.dateid=this.id+"_date",this.timeid=this.id+"_time",setText(this.timeid,e),!this.showdate)return setText(t,e),hideId(this.id),!1;var s=getText(this.dateid);return s.length&&(setText(t,s+" "+e),hideId(this.id)),!1}function CalendarTwoDigits(t){return t>=0&&10>t?"0"+t.toString():t>-10&&0>t?"-0"+(-1*t).toString():t.toString()}